<html>
  <meta name="referrer" content="never">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
  <title>视频预览</title>
  <script src="DPlayer.min.js"></script>
  <style>
	* {
		margin: 0;
		padding: 0;
	}
  </style>
  <body>
    <div id="dplayer"></div>
    <script>
		const dp = new DPlayer({
			container: document.getElementById('dplayer'),
			autoplay: true,
			loop: true,
			playbackSpeed: [0.1, 0.2, 0.3, 0.4, 0.5, 1, 2, 3, 4, 5],
			video: {
				url: getData('url'),
			},
			danmaku: {
				id: getData('name'),
				api: 'danmu.json?',
				addition: [
					getData('name') + '_danmu.json?'
				]
			}
		});
	    	function getData(key)
	    	{
			console.log(getQueryVariable('data'));
			var data = JSON.parse(decodeURIComponent(atob(getQueryVariable('data'))));
			return data[key];
		}
		function getQueryVariable(variable)
		{
			var query = window.location.search.substring(1);
			var vars = query.split("&");
			for (var i=0;i<vars.length;i++) {
				var pair = vars[i].split("=");
				if(pair[0] == variable){return pair[1];}
			}
			return(false);
		}
    </script>
  </body>
</html>
